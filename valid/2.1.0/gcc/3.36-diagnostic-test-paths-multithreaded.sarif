{"$schema": "https://docs.oasis-open.org/sarif/sarif/v2.1.0/errata01/os/schemas/sarif-schema-2.1.0.json",
 "version": "2.1.0",
 "runs": [{"tool": {"driver": {"name": "GNU C23",
                               "fullName": "GNU C23 (GCC) version 15.0.1 20250217 (experimental) (x86_64-pc-linux-gnu)",
                               "version": "15.0.1 20250217 (experimental)",
                               "informationUri": "https://gcc.gnu.org/gcc-15/",
                               "rules": []},
                    "extensions": [{"name": "diagnostic_plugin_test_paths",
                                    "fullName": "./diagnostic_plugin_test_paths.so"}]},
           "invocations": [{"arguments": ["/home/david/coding/work/build/gcc/cc1",
                                          "-quiet",
                                          "-iprefix",
                                          "/home/david/coding/work/install/lib/gcc/x86_64-pc-linux-gnu/15.0.1/",
                                          "-isystem",
                                          "/home/david/coding/work/build/gcc/include",
                                          "-isystem",
                                          "/home/david/coding/work/build/gcc/include-fixed",
                                          "-iplugindir=/home/david/coding/work/build/gcc/plugin",
                                          "/home/david/coding/work/src/gcc/testsuite/gcc.dg/plugin/diagnostic-test-paths-multithreaded-sarif.c",
                                          "-iplugindir=/home/david/coding/work/build/gcc/plugin",
                                          "-quiet",
                                          "-dumpbase",
                                          "diagnostic-test-paths-multithreaded-sarif.c",
                                          "-dumpbase-ext",
                                          ".c",
                                          "-mtune=generic",
                                          "-march=x86-64",
                                          "-fdiagnostics-color=never",
                                          "-fdiagnostics-urls=never",
                                          "-fno-diagnostics-show-caret",
                                          "-fno-diagnostics-show-line-numbers",
                                          "-fdiagnostics-path-format=separate-events",
                                          "-fdiagnostics-text-art-charset=none",
                                          "-fno-diagnostics-show-event-links",
                                          "-fplugin=./diagnostic_plugin_test_paths.so",
                                          "-fdiagnostics-format=sarif-file",
                                          "-o",
                                          "diagnostic-test-paths-multithreaded-sarif.s"],
                            "workingDirectory": {"uri": "/home/david/coding/work/build/gcc/testsuite/gcc"},
                            "startTimeUtc": "2025-02-18T00:44:00Z",
                            "executionSuccessful": true,
                            "toolExecutionNotifications": [],
                            "endTimeUtc": "2025-02-18T00:44:00Z"}],
           "artifacts": [{"location": {"uri": "/home/david/coding/work/src/gcc/testsuite/gcc.dg/plugin/diagnostic-test-paths-multithreaded-sarif.c"},
                          "sourceLanguage": "c",
                          "contents": {"text": "/* { dg-do compile } */\n/* { dg-options \"-fdiagnostics-format=sarif-file\" } */\n\nextern void acquire_lock_a(void);\nextern void acquire_lock_b(void);\n\nvoid foo ()\n{\n  acquire_lock_a ();\n  acquire_lock_b ();\n}\n\nvoid bar ()\n{\n  acquire_lock_b ();\n  acquire_lock_a ();\n}\n\n/* Verify that some JSON was written to a file with the expected name.  */\n/* { dg-final { verify-sarif-file } } */\n\n/* Use a Python script to verify various properties about the generated\n   .sarif file:\n   { dg-final { run-sarif-pytest diagnostic-test-paths-multithreaded-sarif.c \"diagnostic-test-paths-multithreaded-sarif.py\" } } */\n"},
                          "roles": ["analysisTarget",
                                    "tracedFile"]}],
           "results": [{"ruleId": "warning",
                        "level": "warning",
                        "message": {"text": "deadlock due to inconsistent lock acquisition order"},
                        "locations": [{"physicalLocation": {"artifactLocation": {"uri": "/home/david/coding/work/src/gcc/testsuite/gcc.dg/plugin/diagnostic-test-paths-multithreaded-sarif.c"},
                                                            "region": {"startLine": 16,
                                                                       "startColumn": 3,
                                                                       "endColumn": 20},
                                                            "contextRegion": {"startLine": 16,
                                                                              "snippet": {"text": "  acquire_lock_a ();\n"}}}}],
                        "codeFlows": [{"threadFlows": [{"id": "Thread 1",
                                                        "locations": [{"location": {"physicalLocation": {"artifactLocation": {"uri": "/home/david/coding/work/src/gcc/testsuite/gcc.dg/plugin/diagnostic-test-paths-multithreaded-sarif.c"},
                                                                                                         "region": {"startLine": 8,
                                                                                                                    "startColumn": 1,
                                                                                                                    "endColumn": 2},
                                                                                                         "contextRegion": {"startLine": 8,
                                                                                                                           "snippet": {"text": "{\n"}}},
                                                                                    "logicalLocations": [{"name": "foo",
                                                                                                          "fullyQualifiedName": "foo",
                                                                                                          "decoratedName": "foo",
                                                                                                          "kind": "function"}],
                                                                                    "message": {"text": "entering 'foo'"}},
                                                                       "nestingLevel": 0,
                                                                       "executionOrder": 1},
                                                                      {"location": {"physicalLocation": {"artifactLocation": {"uri": "/home/david/coding/work/src/gcc/testsuite/gcc.dg/plugin/diagnostic-test-paths-multithreaded-sarif.c"},
                                                                                                         "region": {"startLine": 9,
                                                                                                                    "startColumn": 3,
                                                                                                                    "endColumn": 20},
                                                                                                         "contextRegion": {"startLine": 9,
                                                                                                                           "snippet": {"text": "  acquire_lock_a ();\n"}}},
                                                                                    "logicalLocations": [{"name": "foo",
                                                                                                          "fullyQualifiedName": "foo",
                                                                                                          "decoratedName": "foo",
                                                                                                          "kind": "function"}],
                                                                                    "message": {"text": "lock a is now held by thread 1"}},
                                                                       "nestingLevel": 1,
                                                                       "executionOrder": 2},
                                                                      {"location": {"physicalLocation": {"artifactLocation": {"uri": "/home/david/coding/work/src/gcc/testsuite/gcc.dg/plugin/diagnostic-test-paths-multithreaded-sarif.c"},
                                                                                                         "region": {"startLine": 10,
                                                                                                                    "startColumn": 3,
                                                                                                                    "endColumn": 20},
                                                                                                         "contextRegion": {"startLine": 10,
                                                                                                                           "snippet": {"text": "  acquire_lock_b ();\n"}}},
                                                                                    "logicalLocations": [{"name": "foo",
                                                                                                          "fullyQualifiedName": "foo",
                                                                                                          "decoratedName": "foo",
                                                                                                          "kind": "function"}],
                                                                                    "message": {"text": "deadlocked due to waiting for lock b in thread 1 (acquired by thread 2 at (4))..."}},
                                                                       "nestingLevel": 1,
                                                                       "executionOrder": 5}]},
                                                       {"id": "Thread 2",
                                                        "locations": [{"location": {"physicalLocation": {"artifactLocation": {"uri": "/home/david/coding/work/src/gcc/testsuite/gcc.dg/plugin/diagnostic-test-paths-multithreaded-sarif.c"},
                                                                                                         "region": {"startLine": 14,
                                                                                                                    "startColumn": 1,
                                                                                                                    "endColumn": 2},
                                                                                                         "contextRegion": {"startLine": 14,
                                                                                                                           "snippet": {"text": "{\n"}}},
                                                                                    "logicalLocations": [{"name": "bar",
                                                                                                          "fullyQualifiedName": "bar",
                                                                                                          "decoratedName": "bar",
                                                                                                          "kind": "function"}],
                                                                                    "message": {"text": "entering 'bar'"}},
                                                                       "nestingLevel": 0,
                                                                       "executionOrder": 3},
                                                                      {"location": {"physicalLocation": {"artifactLocation": {"uri": "/home/david/coding/work/src/gcc/testsuite/gcc.dg/plugin/diagnostic-test-paths-multithreaded-sarif.c"},
                                                                                                         "region": {"startLine": 15,
                                                                                                                    "startColumn": 3,
                                                                                                                    "endColumn": 20},
                                                                                                         "contextRegion": {"startLine": 15,
                                                                                                                           "snippet": {"text": "  acquire_lock_b ();\n"}}},
                                                                                    "logicalLocations": [{"name": "bar",
                                                                                                          "fullyQualifiedName": "bar",
                                                                                                          "decoratedName": "bar",
                                                                                                          "kind": "function"}],
                                                                                    "message": {"text": "lock b is now held by thread 2"}},
                                                                       "nestingLevel": 1,
                                                                       "executionOrder": 4},
                                                                      {"location": {"physicalLocation": {"artifactLocation": {"uri": "/home/david/coding/work/src/gcc/testsuite/gcc.dg/plugin/diagnostic-test-paths-multithreaded-sarif.c"},
                                                                                                         "region": {"startLine": 16,
                                                                                                                    "startColumn": 3,
                                                                                                                    "endColumn": 20},
                                                                                                         "contextRegion": {"startLine": 16,
                                                                                                                           "snippet": {"text": "  acquire_lock_a ();\n"}}},
                                                                                    "logicalLocations": [{"name": "bar",
                                                                                                          "fullyQualifiedName": "bar",
                                                                                                          "decoratedName": "bar",
                                                                                                          "kind": "function"}],
                                                                                    "message": {"text": "...whilst waiting for lock a in thread 2 (acquired by thread 1 at (2))"}},
                                                                       "nestingLevel": 1,
                                                                       "executionOrder": 6}]}]}]}]}]}
