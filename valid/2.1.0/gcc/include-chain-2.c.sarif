{"$schema": "https://docs.oasis-open.org/sarif/sarif/v2.1.0/errata01/os/schemas/sarif-schema-2.1.0.json",
 "version": "2.1.0",
 "runs": [{"tool": {"driver": {"name": "GNU C23",
                               "fullName": "GNU C23 (GCC) version 15.0.1 20250217 (experimental) (x86_64-pc-linux-gnu)",
                               "version": "15.0.1 20250217 (experimental)",
                               "informationUri": "https://gcc.gnu.org/gcc-15/",
                               "rules": [{"id": "-Wanalyzer-double-free",
                                          "helpUri": "https://gcc.gnu.org/onlinedocs/gcc/Static-Analyzer-Options.html#index-Wanalyzer-double-free"}]}},
           "taxonomies": [{"name": "CWE",
                           "version": "4.7",
                           "organization": "MITRE",
                           "shortDescription": {"text": "The MITRE Common Weakness Enumeration"},
                           "taxa": [{"id": "415",
                                     "helpUri": "https://cwe.mitre.org/data/definitions/415.html"}]}],
           "invocations": [{"arguments": ["/home/david/coding/work/build/gcc/cc1",
                                          "-quiet",
                                          "-iprefix",
                                          "/home/david/coding/work/install/lib/gcc/x86_64-pc-linux-gnu/15.0.1/",
                                          "-isystem",
                                          "/home/david/coding/work/build/gcc/include",
                                          "-isystem",
                                          "/home/david/coding/work/build/gcc/include-fixed",
                                          "/home/david/coding/work/src/gcc/testsuite/gcc.dg/sarif-output/include-chain-2.c",
                                          "-quiet",
                                          "-dumpbase",
                                          "include-chain-2.c",
                                          "-dumpbase-ext",
                                          ".c",
                                          "-mtune=generic",
                                          "-march=x86-64",
                                          "-fdiagnostics-color=never",
                                          "-fdiagnostics-urls=never",
                                          "-fno-diagnostics-show-caret",
                                          "-fno-diagnostics-show-line-numbers",
                                          "-fdiagnostics-path-format=separate-events",
                                          "-fdiagnostics-text-art-charset=none",
                                          "-fno-diagnostics-show-event-links",
                                          "-fanalyzer",
                                          "-fdiagnostics-format=sarif-file",
                                          "-o",
                                          "include-chain-2.s"],
                            "workingDirectory": {"uri": "/home/david/coding/work/build/gcc/testsuite/gcc"},
                            "startTimeUtc": "2025-02-18T18:24:11Z",
                            "executionSuccessful": true,
                            "toolExecutionNotifications": [],
                            "endTimeUtc": "2025-02-18T18:24:11Z"}],
           "artifacts": [{"location": {"uri": "/home/david/coding/work/src/gcc/testsuite/gcc.dg/sarif-output/include-chain-2.c"},
                          "sourceLanguage": "c",
                          "roles": ["analysisTarget"]},
                         {"location": {"uri": "/home/david/coding/work/src/gcc/testsuite/gcc.dg/sarif-output/include-chain-2.h"},
                          "sourceLanguage": "c",
                          "contents": {"text": "/* Generate a warning with a diagnostic_path within a header.  */\n\nvoid test (void *ptr)\n{\n  __builtin_free (ptr); // 1st\n  __builtin_free (ptr); // 2nd\n}\n"},
                          "roles": ["resultFile",
                                    "tracedFile"]}],
           "results": [{"ruleId": "-Wanalyzer-double-free",
                        "taxa": [{"id": "415",
                                  "toolComponent": {"name": "cwe"}}],
                        "properties": {"gcc/analyzer/saved_diagnostic/sm": "malloc",
                                       "gcc/analyzer/saved_diagnostic/enode": 5,
                                       "gcc/analyzer/saved_diagnostic/snode": 1,
                                       "gcc/analyzer/saved_diagnostic/stmt": "__builtin_free (ptr_2(D));",
                                       "gcc/analyzer/saved_diagnostic/var": "ptr_2(D)",
                                       "gcc/analyzer/saved_diagnostic/sval": "INIT_VAL(ptr_2(D))",
                                       "gcc/analyzer/saved_diagnostic/state": "freed",
                                       "gcc/analyzer/saved_diagnostic/idx": 0,
                                       "gcc/analyzer/pending_diagnostic/kind": "double_free"},
                        "level": "warning",
                        "message": {"text": "double-'free' of 'ptr'"},
                        "locations": [{"physicalLocation": {"artifactLocation": {"uri": "/home/david/coding/work/src/gcc/testsuite/gcc.dg/sarif-output/include-chain-2.h"},
                                                            "region": {"startLine": 6,
                                                                       "startColumn": 3,
                                                                       "endColumn": 23},
                                                            "contextRegion": {"startLine": 6,
                                                                              "snippet": {"text": "  __builtin_free (ptr); // 2nd\n"}}},
                                       "logicalLocations": [{"name": "test",
                                                             "fullyQualifiedName": "test",
                                                             "decoratedName": "test",
                                                             "kind": "function"}],
                                       "id": 0,
                                       "relationships": [{"target": 1,
                                                          "kinds": ["isIncludedBy"]}]}],
                        "codeFlows": [{"threadFlows": [{"id": "main",
                                                        "locations": [{"properties": {"gcc/analyzer/checker_event/emission_id": "(1)",
                                                                                      "gcc/analyzer/checker_event/kind": "EK_STATE_CHANGE"},
                                                                       "location": {"physicalLocation": {"artifactLocation": {"uri": "/home/david/coding/work/src/gcc/testsuite/gcc.dg/sarif-output/include-chain-2.h"},
                                                                                                         "region": {"startLine": 5,
                                                                                                                    "startColumn": 3,
                                                                                                                    "endColumn": 23},
                                                                                                         "contextRegion": {"startLine": 5,
                                                                                                                           "snippet": {"text": "  __builtin_free (ptr); // 1st\n"}}},
                                                                                    "logicalLocations": [{"name": "test",
                                                                                                          "fullyQualifiedName": "test",
                                                                                                          "decoratedName": "test",
                                                                                                          "kind": "function"}],
                                                                                    "message": {"text": "first 'free' here"},
                                                                                    "id": 2,
                                                                                    "relationships": [{"target": 1,
                                                                                                       "kinds": ["isIncludedBy"]}]},
                                                                       "kinds": ["release",
                                                                                 "memory"],
                                                                       "nestingLevel": 1,
                                                                       "executionOrder": 1},
                                                                      {"properties": {"gcc/analyzer/checker_event/emission_id": "(2)",
                                                                                      "gcc/analyzer/checker_event/kind": "EK_WARNING"},
                                                                       "location": {"physicalLocation": {"artifactLocation": {"uri": "/home/david/coding/work/src/gcc/testsuite/gcc.dg/sarif-output/include-chain-2.h"},
                                                                                                         "region": {"startLine": 6,
                                                                                                                    "startColumn": 3,
                                                                                                                    "endColumn": 23},
                                                                                                         "contextRegion": {"startLine": 6,
                                                                                                                           "snippet": {"text": "  __builtin_free (ptr); // 2nd\n"}}},
                                                                                    "logicalLocations": [{"name": "test",
                                                                                                          "fullyQualifiedName": "test",
                                                                                                          "decoratedName": "test",
                                                                                                          "kind": "function"}],
                                                                                    "message": {"text": "second 'free' here; first 'free' was at [(1)](sarif:/runs/0/results/0/codeFlows/0/threadFlows/0/locations/0)"},
                                                                                    "id": 3,
                                                                                    "relationships": [{"target": 1,
                                                                                                       "kinds": ["isIncludedBy"]}]},
                                                                       "kinds": ["danger"],
                                                                       "nestingLevel": 1,
                                                                       "executionOrder": 2}]}]}],
                        "relatedLocations": [{"physicalLocation": {"artifactLocation": {"uri": "/home/david/coding/work/src/gcc/testsuite/gcc.dg/sarif-output/include-chain-2.c"},
                                                                   "region": {"startLine": 28},
                                                                   "contextRegion": {"startLine": 28,
                                                                                     "snippet": {"text": "#include \"include-chain-2.h\"\n"}}},
                                              "relationships": [{"target": 0,
                                                                 "kinds": ["includes"]},
                                                                {"target": 2,
                                                                 "kinds": ["includes"]},
                                                                {"target": 3,
                                                                 "kinds": ["includes"]}],
                                              "id": 1}]}]}]}
